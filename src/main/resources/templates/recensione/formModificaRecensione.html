<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>SiwRecipes - Modifica Recensione</title>
    <link rel="stylesheet" th:href="@{/css/formRecensione.css}">
</head>

<body>

    <!-- Barra superiore stile login -->
    <div class="form-topbar">
        <div class="form-logo">
            <a th:href="@{/}">
                <img th:src="@{/images/Logo-SiwRecipes.png}" alt="SiwRecipes Logo">
            </a>
        </div>
        <a th:href="@{/ricetta/{id}(id=${recensione.ricetta.id})}" class="btn-back">TORNA INDIETRO</a>
    </div>

    <div class="form-container">
        <div class="form-card">
            <div class="form-header">
                <h1>Modifica <span class="highlight">Recensione</span></h1>
                <p>Aggiorna la tua recensione su "<span th:text="${recensione.ricetta.titolo}">Ricetta</span>"</p>
            </div>

            <form
                th:action="@{/ricetta/{ricettaId}/recensione/edit/{recensioneId}(ricettaId=${recensione.ricetta.id}, recensioneId=${recensione.id})}"
                th:object="${recensione}" method="post" class="review-form">

                <!-- Messaggio di errore -->
                <div th:if="${messaggioErrore}" class="error-message">
                    <span class="error-icon">‚ö†</span>
                    <span th:text="${messaggioErrore}"></span>
                </div>

                <!-- Voto con stelle -->
                <div class="form-group">
                    <label>
                        <span class="label-icon">‚≠ê</span> Il tuo voto *
                    </label>
                    <div class="star-rating-input">
                        <input type="radio" name="voto" value="5" id="star5" th:checked="${recensione.voto == 5}"
                            required>
                        <label for="star5" title="5 stelle">‚òÖ</label>
                        <input type="radio" name="voto" value="4" id="star4" th:checked="${recensione.voto == 4}">
                        <label for="star4" title="4 stelle">‚òÖ</label>
                        <input type="radio" name="voto" value="3" id="star3" th:checked="${recensione.voto == 3}">
                        <label for="star3" title="3 stelle">‚òÖ</label>
                        <input type="radio" name="voto" value="2" id="star2" th:checked="${recensione.voto == 2}">
                        <label for="star2" title="2 stelle">‚òÖ</label>
                        <input type="radio" name="voto" value="1" id="star1" th:checked="${recensione.voto == 1}">
                        <label for="star1" title="1 stella">‚òÖ</label>
                    </div>
                    <span class="rating-text" id="rating-text"
                        th:text="${recensione.voto == 5 ? 'ü§© Eccellente!' : recensione.voto == 4 ? 'üòä Buona' : recensione.voto == 3 ? 'üòê Nella media' : recensione.voto == 2 ? 'üòï Scarsa' : 'üòû Pessima'}">Seleziona
                        un voto</span>
                </div>

                <!-- Testo Recensione -->
                <div class="form-group">
                    <label for="testo">
                        <span class="label-icon">üìù</span> La tua recensione *
                    </label>
                    <textarea id="testo" th:field="*{testo}" rows="6"
                        placeholder="Cosa ne pensi di questa ricetta? Racconta la tua esperienza..."
                        required></textarea>
                    <span class="char-hint">Minimo 10 caratteri</span>
                </div>

                <!-- Bottoni -->
                <div class="form-actions">
                    <a th:href="@{/ricetta/{id}(id=${recensione.ricetta.id})}" class="btn btn-secondary">Annulla</a>
                    <button type="submit" class="btn btn-primary">
                        <span class="btn-icon">üíæ</span> Salva Modifiche
                    </button>
                </div>

            </form>
        </div>
    </div>

    <script>
        // Aggiorna testo del rating quando si seleziona una stella
        const ratingTexts = {
            '1': 'üòû Pessima',
            '2': 'üòï Scarsa',
            '3': 'üòê Nella media',
            '4': 'üòä Buona',
            '5': 'ü§© Eccellente!'
        };

        document.querySelectorAll('.star-rating-input input').forEach(input => {
            input.addEventListener('change', function () {
                document.getElementById('rating-text').textContent = ratingTexts[this.value];
            });
        });
    </script>

</body>

</html>